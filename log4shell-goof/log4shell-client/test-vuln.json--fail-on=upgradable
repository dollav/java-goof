{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Snyk Open Source",
          "properties": {
            "artifactsScanned": 2
          },
          "rules": [
            {
              "id": "SNYK-JAVA-ORGAPACHELOGGINGLOG4J-2327339",
              "shortDescription": {
                "text": "Medium severity - Arbitrary Code Execution vulnerability in org.apache.logging.log4j:log4j-core"
              },
              "fullDescription": {
                "text": "(CVE-2021-44832) org.apache.logging.log4j:log4j-core@2.14.1"
              },
              "help": {
                "text": "",
                "markdown": "* Package Manager: maven\n* Vulnerable module: org.apache.logging.log4j:log4j-core\n* Introduced through: io.snyk:log4shell-client@0.0.1-SNAPSHOT and org.apache.logging.log4j:log4j-core@2.14.1\n### Detailed paths\n* _Introduced through_: io.snyk:log4shell-client@0.0.1-SNAPSHOT â€º org.apache.logging.log4j:log4j-core@2.14.1\n# Overview\n[org.apache.logging.log4j:log4j-core](http://logging.apache.org/log4j/1.2/) is a logging library for Java.\n\nAffected versions of this package are vulnerable to Arbitrary Code Execution. <br /> **Note:** Even though this vulnerability appears to be related to the [log4Shell vulnerability](https://security.snyk.io/vuln/SNYK-JAVA-ORGAPACHELOGGINGLOG4J-2314720), this vulnerability requires an attacker to have access to modify configurations to be exploitable, which is rarely possible.\r\n\r\nAn attacker with access to modification of logging configuration is able to configure `JDBCAppender` with a data source referencing a JNDI URI - which can execute malicious code.\r\n\r\nIn the fixed versions, `JDBCAppender` is using `JndiManager` and disables JNDI lookups by default (via `log4j2.enableJndiJdbc=false`).\r\n\r\n# Alternative Remediation\r\nIf you have reason to believe your application may be vulnerable and upgrading is not an option, you can either:\r\n\r\n* Disable/remove `JDBCAppender`\r\n* If `JDBCAppender` is used, make sure that it is not configured to use any protocol other than Java\n# Remediation\nUpgrade `org.apache.logging.log4j:log4j-core` to version 2.3.2, 2.12.4, 2.17.1 or higher.\n# References\n- [Apache Security Page](https://logging.apache.org/log4j/2.x/security.html)\n- [GitHub Commit](https://github.com/apache/logging-log4j2/commit/05db5f9527254632b59aed2a1d78a32c5ab74f16)\n- [Jira Issue](https://issues.apache.org/jira/browse/LOG4J2-3293)\n- [Openwall Mail](https://www.openwall.com/lists/oss-security/2021/12/28/1)\n"
              },
              "properties": {
                "tags": [
                  "security",
                  "CWE-94",
                  "maven"
                ],
                "cvssv3_baseScore": 6.6,
                "security-severity": "6.6"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "SNYK-JAVA-ORGAPACHELOGGINGLOG4J-2327339",
          "level": "warning",
          "message": {
            "text": "This file introduces a vulnerable org.apache.logging.log4j:log4j-core package with a medium severity vulnerability."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "pom.xml"
                },
                "region": {
                  "startLine": 1
                }
              },
              "logicalLocations": [
                {
                  "fullyQualifiedName": "org.apache.logging.log4j:log4j-core@2.14.1"
                }
              ]
            }
          ],
          "fixes": [
            {
              "description": {
                "text": "Upgrade to org.apache.logging.log4j:log4j-core@2.17.1"
              },
              "artifactChanges": [
                {
                  "artifactLocation": {
                    "uri": "pom.xml"
                  },
                  "replacements": [
                    {
                      "deletedRegion": {
                        "startLine": 1
                      },
                      "insertedContent": {
                        "text": "org.apache.logging.log4j:log4j-core@2.17.1"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
